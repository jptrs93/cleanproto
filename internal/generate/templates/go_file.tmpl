package {{.Package}}

import (
{{- range .Imports}}
    "{{.}}"
{{- end}}
)

{{range .Messages}}
type {{.Name}} struct {
{{- range .Fields}}
    {{.Name}} {{.Type}} `json:"{{.JSONTag}}"`
{{- end}}
}

func (m *{{.Name}}) Encode() []byte {
    var b []byte
{{- range .EncodeLines}}
    {{.}}
{{- end}}
    return b
}

func Decode{{.Name}}(b []byte) (*{{.Name}}, error) {
    var m {{.Name}}
    var num protowire.Number
    var typ protowire.Type
    var err error
{{- if .NeedsMsgBytes}}
    var msgBytes []byte
{{- end}}
{{- if .NeedsTmpBytes}}
    var tmpBytes []byte
{{- end}}
    for len(b) > 0 {
        b, num, typ, err = ConsumeTag(b)
        if err != nil {
            return nil, err
        }
        switch num {
{{- range .DecodeCases}}
        case {{.Number}}:
{{- range .Lines}}
            {{.}}
{{- end}}
{{- end}}
        default:
            b, err = SkipFieldValue(b, num, typ)
        }
        if err != nil {
            return nil, err
        }
    }
    return &m, nil
}

{{end}}
